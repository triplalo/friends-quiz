<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–•—Ç–æ —ñ–∑ –Ω–∞—Å? ü§™</title>
    <!-- –®—Ä–∏—Ñ—Ç -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@600;800&display=swap" rel="stylesheet">
    <!-- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Å–∞–ª—é—Ç–∞ -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root {
            --primary: #FF6B6B;
            --secondary: #4ECDC4;
            --accent: #FFE66D;
            --dark: #2C3E50;
            --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            margin: 0;
            font-family: 'Nunito', sans-serif;
            background: var(--bg-gradient);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow-x: hidden;
            position: relative;
        }

        /* –ü–ª–∞–≤–∞—é—â–∏–µ —Ñ–∏–≥—É—Ä—ã –Ω–∞ —Ñ–æ–Ω–µ */
        .background-shapes {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            overflow: hidden;
            z-index: 0;
            pointer-events: none;
        }
        .shape {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: float 20s infinite linear;
        }
        .shape:nth-child(1) { width: 80px; height: 80px; top: 10%; left: 10%; animation-duration: 25s; }
        .shape:nth-child(2) { width: 120px; height: 120px; top: 70%; left: 80%; animation-duration: 30s; }
        .shape:nth-child(3) { width: 60px; height: 60px; top: 40%; left: 60%; animation-duration: 20s; }
        .shape:nth-child(4) { width: 100px; height: 100px; top: 80%; left: 20%; animation-duration: 28s; }

        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); }
            100% { transform: translateY(-100vh) rotate(360deg); }
        }

        .container {
            position: relative;
            z-index: 10;
            width: 95%;
            max-width: 900px;
            text-align: center;
            padding: 10px;
        }

        h1, .question-text {
            font-family: 'Fredoka One', cursive;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.2);
            letter-spacing: 1px;
        }

        /* --- –≠–ö–†–ê–ù–´ --- */
        .screen {
            display: none;
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .screen.active { display: block; }

        /* –ö–∞—Ä—Ç–æ—á–∫–∞ –≤–≤–æ–¥–∞ */
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            color: var(--dark);
            border: 4px solid white;
        }

        input {
            padding: 15px;
            font-size: 1.3rem;
            border-radius: 20px;
            border: 3px solid #eee;
            width: 90%;
            margin: 20px 0;
            outline: none;
            transition: 0.3s;
            text-align: center;
            font-family: 'Fredoka One', cursive;
            background: #f9f9f9;
            color: var(--dark);
        }
        input:focus {
            border-color: var(--secondary);
            transform: scale(1.02);
        }

        /* 3D –ö–Ω–æ–ø–∫–∞ */
        .btn-3d {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.5rem;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Fredoka One', cursive;
            box-shadow: 0 8px 0 #c0392b, 0 15px 20px rgba(0,0,0,0.2);
            transition: transform 0.1s, box-shadow 0.1s;
            position: relative;
            top: 0;
        }
        .btn-3d:active {
            top: 8px;
            box-shadow: 0 0 0 #c0392b, 0 0 0 rgba(0,0,0,0);
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∞ –≤–æ–ø—Ä–æ—Å–∞ */
        .question-card {
            background: white;
            color: var(--dark);
            border-radius: 25px;
            padding: 20px 15px;
            margin-bottom: 25px;
            box-shadow: 0 10px 0 rgba(0,0,0,0.1);
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .question-text { font-size: 1.5rem; line-height: 1.3; }

        /* –°–µ—Ç–∫–∞ –¥—Ä—É–∑–µ–π */
        .friends-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            padding-bottom: 40px;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∞ –¥—Ä—É–≥–∞ */
        .friend-card {
            background: white;
            border-radius: 20px;
            cursor: pointer;
            padding: 6px;
            box-shadow: 0 6px 0 rgba(0,0,0,0.15);
            transition: all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            top: 0;
        }

        .friend-card:hover {
            transform: translateY(-5px) rotate(-2deg);
            z-index: 2;
        }

        .friend-card:active {
            top: 6px;
            box-shadow: 0 0 0 rgba(0,0,0,0);
            transform: scale(0.95);
        }

        .friend-img {
            width: 100%;
            aspect-ratio: 1 / 1;
            object-fit: cover;
            border-radius: 16px;
            border: 2px solid #f0f0f0;
        }

        .friend-name {
            margin-top: 5px;
            font-weight: 800;
            color: var(--dark);
            font-size: 0.85rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä (–ø–æ–ª–æ—Å–∞—Ç—ã–π) */
        .progress-container {
            background: rgba(0,0,0,0.2);
            border-radius: 20px;
            padding: 4px;
            margin-bottom: 20px;
            height: 25px;
        }
        .progress-bar {
            height: 100%;
            background: repeating-linear-gradient(
                45deg,
                var(--secondary),
                var(--secondary) 10px,
                #43babb 10px,
                #43babb 20px
            );
            background-size: 200% 200%;
            border-radius: 15px;
            width: 0%;
            transition: width 0.3s ease;
            animation: stripeMove 1s linear infinite;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        @keyframes stripeMove { 100% { background-position: 28px 0; } }
        @keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        /* –ê–¥–∞–ø—Ç–∏–≤ */
        @media (max-width: 650px) {
            .friends-grid { grid-template-columns: repeat(3, 1fr); gap: 10px; }
            .question-text { font-size: 1.2rem; }
            .btn-3d { padding: 12px 30px; font-size: 1.2rem; }
        }
    </style>
</head>
<body>

    <!-- –ñ–∏–≤–æ–π —Ñ–æ–Ω -->
    <div class="background-shapes">
        <div class="shape"></div>
        <div class="shape"></div>
        <div class="shape"></div>
        <div class="shape"></div>
    </div>

    <!-- –ó–≤—É–∫–∏ -->
    <audio id="sound-pop" src="click.mp3" preload="auto"></audio>
    <audio id="sound-win" src="win.mp3" preload="auto"></audio>

    <div class="container">
        
        <!-- –≠–ö–†–ê–ù 1: –í—Ö–æ–¥ -->
        <div id="screen-start" class="screen active">
            <div class="glass-card">
                <h1 style="color: var(--primary); font-size: 2.5rem;">–ü—Ä–∏–≤–µ—Ç–∏–∫! üëã</h1>
                <p style="font-size: 1.1rem; opacity: 0.8;">–í–≤–µ–¥–∏ —Å–≤–æ–µ –∏–º—è, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å:</p>
                <input type="text" id="nickname-input" placeholder="–ò–º—è / –ü–æ–∑—ã–≤–Ω–æ–π" autocomplete="off">
                <br>
                <button class="btn-3d" onclick="startGame()">–ü–û–ì–ù–ê–õ–ò! üöÄ</button>
            </div>
        </div>

        <!-- –≠–ö–†–ê–ù 2: –ò–≥—Ä–∞ -->
        <div id="screen-game" class="screen">
            <div class="progress-container">
                <div class="progress-bar" id="progress"></div>
            </div>

            <div class="question-card">
                <div class="question-text" id="question">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>

            <div class="friends-grid" id="friends-container">
                <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ -->
            </div>
        </div>

        <!-- –≠–ö–†–ê–ù 3: –§–∏–Ω–∞–ª -->
        <div id="screen-end" class="screen">
            <div class="glass-card">
                <h1 style="color: var(--secondary);">–ì–æ—Ç–æ–≤–æ! üéâ</h1>
                <p>–¢–≤–æ–∏ –æ—Ç–≤–µ—Ç—ã —É–ª–µ—Ç–µ–ª–∏.</p>
                <p style="font-weight: bold;">–°–∫–æ—Ä–æ —É–∑–Ω–∞–µ–º –ø—Ä–∞–≤–¥—É!</p>
                <div style="font-size: 5rem; margin-top: 20px; animation: popIn 1s infinite alternate;">üòé</div>
            </div>
        </div>

    </div>

    <script>
        // ================= –ù–ê–°–¢–†–û–ô–ö–ò =================

        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxcOhsIlJ-DMNMWw7LY4ZpShGlM6jZc91s_e6pd7HFRqbZcJjz621WBPohJ1UEORo4/exec'; 

        const friendsData = [
            { name: "–ú–∞–∫—Å–∏–º", img: "1.jpg" },
            { name: "–Ø—Ä–∏–∫", img: "2.jpg" },
            { name: "–ö–æ—Å—Ç—è", img: "3.jpg" },
            { name: "–Ñ–≥–æ—Ä–æ–≤", img: "4.jpg" },
            { name: "–ì–Ω–∞—Ç", img: "5.jpg" },
            { name: "–¢—ñ–º–∞", img: "6.jpg" },
            { name: "–õ—å–æ—Ö–∞", img: "7.jpg" },
            { name: "–í–∞—Ä–µ–Ω—ñ–∫", img: "8.jpg" },
            { name: "–ë–∞—Å—é–∫", img: "9.jpg" },
            { name: "–Ñ–≥–æ—Ä", img: "10.jpg" },
            { name: "–î–∞–Ω—è", img: "11.jpg" },
            { name: "–ù–µ–∑", img: "12.jpg" },
            { name: "–Ü–≤–∞–Ω", img: "13.jpg" },
            { name: "–Ñ–≤—Å–µ–Ω–∫–æ", img: "14.jpg" },
            { name: "–¢–µ—Ö–Ω—ñ—á–Ω–∏–π", img: "15.jpg" }
        ];

        const questions = [
            "–•—Ç–æ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ —Å–ø—ñ—Ç? üò¥",
            "–•—Ç–æ –∞–±—Å–æ–ª—é—Ç–Ω–∏–π –ª–æ—Ö? ü§°",
            "–•—Ç–æ –ª—É—á—à–∏–π –≥–µ–π–º–µ—Ä? üéÆ",
            "–•—Ç–æ —Å–∞–º–∏–π —Ç–æ–∫—Å–∏—á–Ω—ñ–π, –Ω–æ –º–∏ –µ–≤–æ –ª—é–±–∏–º? ‚ò£Ô∏è",
            "–•—Ç–æ —Å–∞–º–∏–π –∞–∫—Ç–∏–≤–Ω–∏–π? ‚ö°",
            "–•—Ç–æ —Å—Ç–∞–Ω–µ—Ç –º—ñ–ª–ª–∏–æ–Ω–µ—Ä–æ–º (–∏–ª–∏ —Å—è–¥–µ—Ç –≤ —Ç—é—Ä—å–º—É)? üí∞",
            "–ö—Ç–æ —á–∞—â–µ –≤—Å–µ—Ö –æ–ø–∞–∑–¥—ã–≤–∞–µ—Ç? üê¢",
            "–ö–æ–º—É –Ω–µ–ª—å–∑—è –¥–æ–≤–µ—Ä—è—Ç—å —Å–µ–∫—Ä–µ—Ç–∏? ü§ê",
            "–•—Ç–æ –≤—ñ–π–¥–µ—Ç –∂–µ–Ω—ñ—Ç—Å—è –ø–µ—Ä–≤–∏–º? üíç",
            "–•—Ç–æ –≤—Å–µ–≥–¥–∞ –ø–æ—Ä—Ç–∏—Ç –≤–∞–π–±—ñ–∫? üò§",
            "–•—Ç–æ –±–æ–ª—å—à–µ –≤—Å–µ—Ö –ø—å–µ—Ç? üç∫",
            "–•—Ç–æ —à—É—Ç–∏—Ç —Ö—É–∂–µ –≤—Å—î–≥–æ? ü¶ó",
            "–•—Ç–æ –≥–æ–ª–æ–≤–Ω–∏–π –ß–°–í? üëë",
            "–•—Ç–æ —Å–∞–º–∏–π –±–æ–ª—å—à–æ–π –ø–æ–¥–∫–∞–±–ª—É—á–Ω—ñ–∫? üë†",
            "–•—Ç–æ —Å–∞–º–∏–π –≥–∞—Ä–Ω—ñ—à–∏–π? üòç"
        ];

        // ================= –õ–û–ì–ò–ö–ê =================

        let currentQuestionIndex = 0;
        let answers = {}; 
        let userNickname = "–ê–Ω–æ–Ω–∏–º";

        const screenStart = document.getElementById('screen-start');
        const screenGame = document.getElementById('screen-game');
        const screenEnd = document.getElementById('screen-end');
        
        const questionEl = document.getElementById('question');
        const friendsContainer = document.getElementById('friends-container');
        const progressEl = document.getElementById('progress');
        const nicknameInput = document.getElementById('nickname-input');
        const soundPop = document.getElementById('sound-pop');
        const soundWin = document.getElementById('sound-win');

        function startGame() {
            const name = nicknameInput.value.trim();
            if (!name) {
                // –¢—Ä—è—Å–∫–∞ –ø–æ–ª—è –≤–≤–æ–¥–∞ –µ—Å–ª–∏ –Ω–µ—Ç –∏–º–µ–Ω–∏
                nicknameInput.style.border = "3px solid red";
                setTimeout(() => nicknameInput.style.border = "3px solid #eee", 500);
                return;
            }
            userNickname = name;
            
            screenStart.classList.remove('active');
            screenGame.classList.add('active');
            
            // –ü—ã—Ç–∞–µ–º—Å—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∞—É–¥–∏–æ
            soundPop.volume = 0.5;
            soundWin.volume = 0.4;
            
            initGame();
        }

        function initGame() {
            renderFriends();
            showQuestion();
        }

        function renderFriends() {
            friendsContainer.innerHTML = '';
            friendsData.forEach(friend => {
                const card = document.createElement('div');
                card.className = 'friend-card';
                
                const img = document.createElement('img');
                img.src = friend.img; 
                img.className = 'friend-img';
                img.onerror = function() { this.src = 'https://via.placeholder.com/150/FF6B6B/FFFFFF?text=' + friend.name[0]; };

                const nameDiv = document.createElement('div');
                nameDiv.className = 'friend-name';
                nameDiv.textContent = friend.name;

                card.appendChild(img);
                card.appendChild(nameDiv);

                card.onclick = () => {
                    playPop();
                    // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ –Ω–∞–∂–∞—Ç–∏—è
                    setTimeout(() => handleAnswer(friend.name), 100);
                };
                
                friendsContainer.appendChild(card);
            });
        }

        function showQuestion() {
            questionEl.style.opacity = 0;
            questionEl.style.transform = "scale(0.8) translateY(20px)";
            
            setTimeout(() => {
                questionEl.textContent = questions[currentQuestionIndex];
                questionEl.style.transition = "all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275)";
                questionEl.style.opacity = 1;
                questionEl.style.transform = "scale(1) translateY(0)";
                updateProgress();
            }, 150);
        }

        function updateProgress() {
            const percent = (currentQuestionIndex / questions.length) * 100;
            progressEl.style.width = percent + '%';
        }

        function handleAnswer(selectedName) {
            const currentQuestion = questions[currentQuestionIndex];
            answers[currentQuestion] = selectedName;
            
            currentQuestionIndex++;

            if (currentQuestionIndex < questions.length) {
                showQuestion();
            } else {
                finishGame();
            }
        }

        function finishGame() {
            screenGame.classList.remove('active');
            screenEnd.classList.add('active');
            
            soundWin.play().catch(e => {});

            // –ó–ê–ü–£–°–ö –°–ê–õ–Æ–¢–ê!
            triggerConfetti();

            sendDataToGoogleSheet();
        }

        function triggerConfetti() {
            const duration = 3000;
            const end = Date.now() + duration;

            (function frame() {
                confetti({
                    particleCount: 5,
                    angle: 60,
                    spread: 55,
                    origin: { x: 0 },
                    colors: ['#FF6B6B', '#4ECDC4', '#FFE66D']
                });
                confetti({
                    particleCount: 5,
                    angle: 120,
                    spread: 55,
                    origin: { x: 1 },
                    colors: ['#FF6B6B', '#4ECDC4', '#FFE66D']
                });

                if (Date.now() < end) {
                    requestAnimationFrame(frame);
                }
            }());
        }

        function playPop() {
            soundPop.currentTime = 0;
            soundPop.play().catch(e => {}); 
        }

        function sendDataToGoogleSheet() {
            const dataToSend = {
                nickname: userNickname, 
                answers: answers
            };

            fetch(GOOGLE_SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(dataToSend)
            });
        }
    </script>
</body>
</html>
